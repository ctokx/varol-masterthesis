import{H as t,c as m}from"./0f34bc84b746331fb6e6d1a17e2be5f1.js";import"./d541e75e0d3013fe2efd3bb1a31c4a6b.js";import"./3f2064fa9a9acc842de50ad820610f4b.js";import"./7e56edcc34c4dfd4bce3410bed0529e6.js";import"./aca89d4ca34e8fbbc6f322cb34935489.js";import"./17e6f969c69a33c57a5b808c30e97817.js";import"./8fd9dd871ac56148ba64599be5846cf8.js";import"./71531b053591a96d81db2519a82aa248.js";import"./c12fd3596e1e986fac56d091ec67c779.js";import"./0db5daaf91bdd56249e9ae30e1c0fad3.js";import"./4bf0dc39263bec45ac08f22b6445195f.js";import"./bd5159ed1face2f59751ceb1d07e31f3.js";import"./9f935c62533cde17533373075512c98b.js";import"./22aa1f89111f8237764a195a86dc6791.js";import"./1c66977a9e497032052fc88de8dc0025.js";import"./2eb62d616ebc70b625c1907fb9b56bcb.js";import"./167eb5fb14130edc55e0208b299eb738.js";import"./e43206e4b2ef10bccecb7d9deb74b927.js";import"./39c3d8a964c661ab72f6d2e5dcdb0e9a.js";import"./0a9beade9558a5b904150914951edb50.js";let g=(e,o,r)=>t.sendMessageListener(e,o,r),k=(e,o,r)=>t.sendMessageListener(e,o,r,!0),h;function w(e){h=e,h.postMessage({greeting:"hi there content script!"}),h.onMessage.addListener((e=>{console.log("In background script, received message from content script"),console.log(e.greeting)}))}t.Browser().runtime.onMessage.hasListener(g)||t.Browser().runtime.onMessage.addListener(g),t.Browser().runtime.onMessage.hasListener(k)||t.Browser().runtime.onMessageExternal.addListener(k),t.Browser().runtime.onConnect.hasListener(w)||t.Browser().runtime.onConnect.addListener(w);class U{captaina_version="1.1.0";this_page="#reload#";hopekey=null;merchants=null;start_key=0;check_key_time=null;site_url="https://captaina.co";development_url="https://locallhost";custom_url=["captaina.com"].concat(this.site_url).concat(this.development_url);marketplace_idBydomain={};market_urls={"amazon.fr":"A13V1IB3VIYZZH","amazon.sa":"A17E79C6D8DWNP","amazon.nl":"A1805IZSGTT6HS","amazon.sg":"A19VAU5U5O7RUS","amazon.com.mx":"A1AM78C64UM0Y8","amazon.pl":"A1C3SOZRARQ6R3","amazon.co.uk":"A1F83G8C2ARO7P","amazon.de":"A1PA6795UKMFR9","amazon.es":"A1RKKUPIHCS9HS","amazon.co.jp":"A1VC38T7YXB528","amazon.in":"A21TJRUUN4KGV","amazon.ca":"A2EUQ1WTGCTBG2","amazon.se":"A2NODRKZP88ZB9","amazon.com.br":"A2Q3Y263D00KWC","amazon.ae":"A2VIGQ35RCS4UG","amazon.com.tr":"A33AVAJ2PDY3EV","amazon.com.au":"A39IBJ37TRP1C6","amazon.com.be":"AMEN7PMS3EDWL","amazon.it":"APJ6JRA9NG5V4","amazon.eg":"ARBP9OOSHTCHU","amazon.com":"ATVPDKIKX0DER"};market_host_by_details={"amazon.fr":{country_code:"fr",currency:"EUR",currency_symbol:"€",currency_position:"1"},"amazon.sa":{country_code:"sa",currency:"SAR",currency_symbol:"﷼",currency_position:"0"},"amazon.nl":{country_code:"nl",currency:"EUR",currency_symbol:"€",currency_position:"1"},"amazon.sg":{country_code:"sg",currency:"SGD",currency_symbol:"$",currency_position:"0"},"amazon.com.mx":{country_code:"mx",currency:"MXN",currency_symbol:"$",currency_position:"0"},"amazon.pl":{country_code:"pl",currency:"PLN",currency_symbol:"zł",currency_position:"0"},"amazon.co.uk":{country_code:"gb",currency:"GBP",currency_symbol:"£",currency_position:"0"},"amazon.de":{country_code:"de",currency:"EUR",currency_symbol:"€",currency_position:"0"},"amazon.es":{country_code:"es",currency:"EUR",currency_symbol:"€",currency_position:"1"},"amazon.co.jp":{country_code:"jp",currency:"JPY",currency_symbol:"¥",currency_position:"0"},"amazon.in":{country_code:"in",currency:"INR",currency_symbol:"₹",currency_position:"0"},"amazon.ca":{country_code:"ca",currency:"CAD",currency_symbol:"$",currency_position:"0"},"amazon.se":{country_code:"se",currency:"SEK",currency_symbol:"kr",currency_position:"1"},"amazon.com.br":{country_code:"br",currency:"BRL",currency_symbol:"R$",currency_position:"0"},"amazon.ae":{country_code:"ae",currency:"aED",currency_symbol:"د.إ",currency_position:"0"},"amazon.com.tr":{country_code:"tr",currency:"TRY",currency_symbol:"₺",currency_position:"1"},"amazon.com.au":{country_code:"au",currency:"aUD",currency_symbol:"$",currency_position:"0"},"amazon.com.be":{country_code:"be",currency:"EUR",currency_symbol:"€",currency_position:"1"},"amazon.it":{country_code:"it",currency:"EUR",currency_symbol:"€",currency_position:"1"},"amazon.eg":{country_code:"eg",currency:"EGP",currency_symbol:"جنيه",currency_position:"0"},"amazon.com":{country_code:"us",currency:"USD",currency_symbol:"$",currency_position:"0"}};market_pattern_urls=[];pattern_urls=[];debugMode=!1;debugInfo=!1;api_url="https://_crawl.captaina.co";check_notifications_executing=!1;constructor(){this.setKey(),Object.keys(this.market_urls).forEach((e=>{this.market_pattern_urls.push("https://*."+e+"/*"),this.marketplace_idBydomain[this.market_urls[e]]="https://www."+e})),Object.keys(this.market_urls).forEach((e=>{this.pattern_urls.push("https://*."+e+"/*"),this.marketplace_idBydomain[this.market_urls[e]]="https://www."+e})),this.custom_url.forEach((e=>{-1===e.indexOf("!*")?this.pattern_urls.push("https://*."+e.replace("https://","")+"/*"):this.pattern_urls.push(e)}))}setKey(e=!0){return 1==this.start_key||Math.floor((Date.now()-this.check_key_time)/1e3)<=1&&null!=this.check_key_time?t.Browser().storage.local.get("hopekey"):(this.debugMode&&console.log(this.check_key_time,Math.floor((Date.now()-this.check_key_time)/1e3)<=1||null==this.check_key_time),this.check_key_time=Date.now(),t.Browser().storage.local.get("hopekey").then((e=>typeof e.hopekey<"u"?(this.hopekey=e.hopekey??null,null==this.hopekey||"false"==this.hopekey?(fetch(this.api_url+"auth/logout",{method:"POST",headers:{"Content-Type":"application/json"}}).then((e=>e.text())),t.Browser().storage.local.remove(["hopekey","merchants","credits"]).then()):t.Browser().storage.local.get("merchants").then((e=>{typeof e.merchants<"u"&&(this.merchants=e.merchants)}))):(this.start_key=1,fetch(this.site_url+"/extensions/app/get_key",{method:"POST",headers:{"Content-Type":"application/json"}}).then((e=>e.text())).then((e=>{if(typeof(e=JSON.parse(e)).data<"u"&&typeof e.data.key<"u"){if(this.debugMode&&console.log({hopekey:e.data.key}),t.Browser().storage.local.set({hopekey:e.data.key}).then(),typeof e.data.licences<"u"&&typeof e.data.licences.markets<"u"){let o={merchants:e.data.licences.markets};t.Browser().storage.local.set(o).then(),this.merchants=o.merchants}if(typeof e.data.token_usage<"u"&&typeof e.data.token_usage<"u"){let o={credits:e.data.token_usage};t.Browser().storage.local.set(o).then()}t.Browser().storage.local.set({is_login:!0}).then(),this.hopekey=e.data.key,this.debugMode&&console.log(this.merchants,this.hopekey)}this.start_key=0,this.debugMode&&console.log(e)})).catch((e=>{this.start_key=0,this.debugMode&&console.log(e)}))))))}getKey(){return t.Browser().storage.local.get("hopekey").then((e=>{typeof e.hopekey<"u"&&(this.hopekey=e.hopekey??null)}))}}new U;let b=!1;if(typeof window>"u"){var B=e=>{{let o=!1;"install"==e.reason&&(o=!0),t.clearStorage(o),t.Browser().tabs.query({url:`${m.extension_main_dir}/setup.html`}).then((e=>{e.forEach((e=>{console.log(e),t.Browser().tabs.remove(e.id)}))}))}b||(b=!0,t.settingsBuild(!0).then((o=>{if("update"==e.reason&&typeof o.settings<"u"){let e=o.settings;t.Browser().storage.local.set({settings:e})}"install"==e.reason&&t.openPage({url:`${m.extension_main_dir}/setup.html`})})))};t.Browser().runtime.onInstalled.addListener((async e=>B(e))),t.Browser().runtime.onUpdateAvailable.addListener((e=>B(e))),t.Browser().runtime.setUninstallURL(m.site+"/uninstall"),t.Browser().storage.local.set({migrate_test:1}),t.Browser().storage.local.get("uuid_hopekey").then((e=>{if(null==e.uuid_hopekey)return t.uuid(1)})),t.Browser().action.onClicked.addListener((t=>{e()})),t.Browser().runtime.onMessage.addListener(((o,r,n)=>{if("action.onCaptureScreen"==o.fn){const{data:e}=o.data,{x:r,y:n,width:c,height:a,windowWidth:s}=e;if(!c||!a)return;t.captureCurrentViewport().then((e=>{fetch(e).then((e=>e.blob())).then((e=>{createImageBitmap(e).then((e=>{const o=e.width/s,i=r*o,u=n*o,l=c*o,m=a*o,y=new OffscreenCanvas(l,m);y.getContext("2d").drawImage(e,i,u,l,m,0,0,l,m),y.convertToBlob().then((e=>{const o=new FileReader;o.readAsDataURL(e),o.onloadend=()=>{const e=o.result;t.Browser().storage.local.set({ai_image_url:e}).then()}}))}))}))})).catch((e=>console.error(e)))}"action.onSpeechOpenPanel"==o.fn&&e("speech",r),"action.closeSidePanel"==o.fn&&e("close",r),"action.onSpeech"==o.fn&&e("speech",r)}));let e=(e="",o=null)=>{if(t.Browser().sidePanel.setPanelBehavior({openPanelOnActionClick:!0}).catch((e=>console.error(e))),""==e)return t.Browser().sidePanel.setOptions({enabled:!0}),!0;o.tab&&(t.Browser().sidePanel.setOptions({enabled:!0,path:`/src/html/side_panel.html?action=${e}&t=${(new Date).getTime()}`}),t.Browser().sidePanel.open({tabId:o.tab.id}))}}