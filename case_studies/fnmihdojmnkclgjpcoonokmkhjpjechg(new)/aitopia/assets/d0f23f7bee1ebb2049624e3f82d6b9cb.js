import{H as e,c as n}from"./6da4b6d82d745093c67f68f3dfd58024.js";import"./d9ead636e14b3dea7802a6c456951ba1.js";import"./ddf3c1fa2deb5d26638675926c7b9d09.js";import"./0adcd388c9aaa32c0cc27d4165b3d44d.js";import"./cde26fce7a7372b6951c2916a9851051.js";import"./c775b28d320b0f76df5f528bc49f6aa4.js";import"./556eec616e9e2e42b8c2aa2bb68d535c.js";import"./0d312bf4a86f7694fa93a4b284d7250e.js";import"./e10687645c95ce1b6a3461c73a73ba81.js";import"./6bde0597aea7748c1fc7d905f85ec069.js";import"./6b2aa0f0aa2b0110b5bd650a97a56803.js";import"./0b28c5808c8427156e8784d960d4e59e.js";import"./1539025a706a9e27b0becf940dc1c28a.js";import"./af99b7f1a072a4003eb9ccc27570713e.js";import"./7e175aa4d215965863ad94e5816e68dc.js";import"./b89c276e0b74378882f480951f4bde2a.js";import"./f40af6e9496ae6e6e39e8fe1c143aa85.js";import"./1343aedc4180a91956bf1ecf1fac242a.js";import"./5ae9c9acb1c829f4ab2c50786720e5cf.js";import"./6d1994eb1dc6c7b66d71c8cf9501e5ea.js";let h=!1;if(typeof window>"u"){var m=r=>{fetch("/partner.json").then(a=>a.json()).then(a=>{let o={app_name:n.app_name,app_title:n.app_title,app_description:n.app_description,app_logo:n.app_logo,app_logo_full:n.app_logo_full,app_search_title:n.app_search_title,app_main_color:n.app_main_color,app_main_color_dark:n.app_main_color_dark,app_main_link_color:n.app_main_link_color,app_main_link_color_dark:n.app_main_link_color_dark,app_store_url:n.app_store_url,app_install:!1,app_uninstall:!1,app_context:!1},i=[];Object.keys(a).forEach(t=>{a[t]!==null&&(typeof a[t]=="string"&&(a[t].indexOf(".svg")!==-1&&i.push(`app_${t}`),t.indexOf("color")&&a[t].indexOf("#")===0&&(a[t]=e.hex2rgb(a[t]))),o[`app_${t}`]=a[t])}),i.forEach(t=>{fetch(o[t]).then(p=>p.text()).then(p=>{o[t]=p.trim().replace(/[\r\n]+/gm,""),e.Browser().storage.local.set({app_details:o})})}),e.Browser().storage.local.set({app_details:o})}).catch(a=>{console.log(a)}).finally(()=>{e.Browser().storage.local.get("app_details").then(a=>{let o=a.app_details??{app_install:!1,app_uninstall:!1,app_context:!1};o.app_uninstall&&e.Browser().runtime.setUninstallURL(n.site+"/uninstall?ex="+n.extension_id),!h&&(h=!0,e.settingsBuild(!0).then(i=>{let t=i;typeof i.settings<"u"&&(t=i.settings),typeof t.ai_key<"u"&&(r.reason=="install"&&(t=Object.assign(t,{context_reading:o.app_context,context_writing:o.app_context,context_writing_input:o.app_context})),e.Browser().storage.local.set({settings:t})),r.reason=="install"&&o.app_install&&e.openPage({url:n.extension_main_dir+"/setup.html"})}))})})};e.onMessageListener(),e.Browser().runtime.onInstalled.addListener(async r=>m(r)),e.Browser().runtime.onUpdateAvailable.addListener(r=>m(r)),e.Browser().runtime.onMessage.addListener(async r=>{if(r.fn=="action.onCaptureScreen"){const{data:a}=r.data,{x:o,y:i,width:t,height:p,windowWidth:w}=a;if(!t||!p)return;e.captureCurrentViewport().then(s=>{fetch(s).then(_=>_.blob()).then(_=>{createImageBitmap(_).then(u=>{const l=u.width/w,x=o*l,B=i*l,c=t*l,d=p*l,g=new OffscreenCanvas(c,d);g.getContext("2d").drawImage(u,x,B,c,d,0,0,c,d),g.convertToBlob().then(k=>{const f=new FileReader;f.readAsDataURL(k),f.onloadend=()=>{const y=f.result;e.Browser().storage.local.set({ai_image_url:y}).then()}})})})}).catch(s=>console.error(s))}}),e.Browser().storage.local.set({migrate_test:1}),e.Browser().storage.local.get("uuid_hopekey").then(r=>{if(r.uuid_hopekey==null)return e.uuid(1)})}
