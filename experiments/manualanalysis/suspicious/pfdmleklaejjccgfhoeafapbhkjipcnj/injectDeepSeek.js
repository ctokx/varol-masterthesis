console.log("Content script initialized"),window.addEventListener("message",(async e=>{if(console.log("window.addEventListener, event.type =",e.data.type),"INSERT_TEXT"===e.data.type||"INSERT_SUMMARY"===e.data.type){console.log("Attempting to insert text:",e.data.text);const t=async(e=0)=>{const n=["#chat-input"];for(const e of n){const t=document.querySelector(e);if(t)return t}return e<5?(await new Promise((e=>setTimeout(e,500))),t(e+1)):null},n=()=>document.getElementById("send-message-button");try{const o=await t();if(!o)return void console.warn("Chat input not found");console.log(o,"chatInput"),o.value=e.data.text,o.dispatchEvent(new Event("input",{bubbles:!0,cancelable:!0}));Object.getOwnPropertyDescriptor(window.HTMLTextAreaElement.prototype,"value").set.call(o,e.data.text),o.dispatchEvent(new Event("change",{bubbles:!0})),"INSERT_SUMMARY"===e.data.type&&setTimeout((()=>{const e=n();e?e.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0})):(console.warn("Send button not found, trying fallback"),o.dispatchEvent(new KeyboardEvent("keydown",{key:"Enter",code:"Enter",keyCode:13,which:13,bubbles:!0,ctrlKey:!0})))}),300)}catch(e){console.error("Error inserting text:",e)}}}));
