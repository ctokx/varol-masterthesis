(()=>{let c=null,s=null;function d(e,t){e&&(t?(e.classList.remove("sidepanel-animate-out"),e.classList.add("sidepanel-animate-in")):(e.classList.remove("sidepanel-animate-in"),e.classList.add("sidepanel-animate-out")))}async function l(e,t){var e=await(await fetch(chrome.runtime.getURL(e))).text(),a=document.createElement("style");a.textContent=e,t.appendChild(a)}async function o(t){var a=document.getElementById("chatBot-sidepanel-container");if(a)d(a,t),d(c,t);else{let e=await(await fetch(chrome.runtime.getURL("sidePanel.html"))).text();var a=t?"sidepanel-animate-in":"sidepanel-animate-out",t=(e=`<div id="chatBot-sidepanel-container" class="sidePanelWrapper ${a}">${e=(e=e.replace('<link rel="stylesheet" href="sidePanel.css">',"")).replace('<script src="sidePanel.js"><\/script>',"")}</div>`,document.createElement("div")),n=(t.id="chatBot-sidepanel-container",t.classList.add("sidePanelWrapper"),document.body.appendChild(t),t.attachShadow({mode:"open"})),i=document.createElement("div");i.innerHTML=e,n.appendChild(i),t.classList.add(a);try{await l("sidePanelWrapper.css",n),await l("sidePanel.css",n)}catch(e){}try{chatBotSidepanelMainFunction(n,!1,()=>{try{var e=document.getElementById("chatBot-sidepanel-container");e&&(d(e,!1),d(c,!1))}catch(e){}})}catch(e){}c=n.getElementById("chatBot-sidepanel-container"),s=n}}window.location.href.includes("showSidepanelOnPageLoad=true")&&o(!0),chrome.runtime.onMessage.addListener(async(e,t,a)=>{function n(){var e="https://gemini.talkai.info/chat/",t=s?.getElementById?.("chatBot-sidepanel-iframe");t&&t.src!==e&&(t.src=e)}var i;return"switchPanelVisibility"===e.action?(o(!((i=document.getElementById("chatBot-sidepanel-container"))&&i.classList.contains("sidepanel-animate-in"))),n()):"closeSidePanel"===e.action&&((i=document.getElementById("chatBot-sidepanel-container"))&&(d(i,!1),d(c,!1)),n()),!0}),chrome.runtime.onMessage.addListener((e,t,a)=>{"getPageText"===e.action&&a({pageContent:document.body.innerText.trim(),url:window.location.href})})})();