"use strict";(function(){const c="gm",d="AgYPAAMJBR0BCAsFAwQEAw8GCAADAhcDCQ8MDg8JAw4=",g=chrome,p=location.host.includes("poe.com"),a=location.host.includes("moonvy.com"),h=location.host.includes("ideogram.ai"),f=location.host.includes("suno.com"),w=location.host.includes("chatgpt.com"),A=location.host.includes("grok.com"),I=location.host.includes("chat.qwen.ai")||location.host.includes("qianwen.com"),_=location.host.includes("lovart.ai"),S="runtime",y=location.host.includes("gemini.google.com")||location.host.includes("aistudio.google.com")||location.host.includes("labs.google"),E=location.host.includes("labs.google")&&!(location.pathname.startsWith("/fx")&&location.pathname.includes("/tools/flow")),C=location.host.includes("doubao.com"),r=/jimeng\.jianying\.com/.test(location.host)||/dreamina\.capcut\.com/.test(location.host),M=r&&location.pathname.includes("/ai-tool/image-edit"),L="id";function D(o){const t=c,e=atob(o);let m="";for(let n=0;n<e.length;n++)m+=String.fromCharCode(e.charCodeAt(n)^t.charCodeAt(n%t.length));return m}const b=["jm","db","qwen"].includes(c),l=typeof __ldm__<"u",u=D(d)!==g[S][L],s=C?"AutoDoubao":r?"Autojimeng":f?"AutoSuno":w?"AutoGPT":y?"AutoGemini":h?"Autogram":A?"AutoGrok":_?"AutoLovart":I?"AutoQwen":"Autojourney",j=30;function i(o){const t=document.createElement("script");t.setAttribute("type","text/javascript"),t.setAttribute("src",o),document.documentElement.appendChild(t)}async function N(){let t=(await chrome.storage.local.get("clientId")).clientId;return t||(t=self.crypto.randomUUID(),await chrome.storage.local.set({clientId:t})),t}async function G(){let{sessionData:o}=await chrome.storage.session.get("sessionData");const t=Date.now();return o&&o.timestamp&&((t-o.timestamp)/6e4>j?o=null:(o.timestamp=t,await chrome.storage.session.set({sessionData:o}))),o||(o={session_id:t.toString(),timestamp:t.toString()},await chrome.storage.session.set({sessionData:o})),o.session_id}function O(){window.addEventListener("message",async o=>{const t=o.data;if(t?.source===s){if(t?.to==="background")try{chrome.runtime&&chrome.runtime.sendMessage(t,function(e){chrome.runtime.lastError&&console.error(chrome.runtime.lastError),e?.source===s&&e?.to==="page"&&window.postMessage(e,"*")})}catch(e){console.error(e)}else if(t?.to==="content"){if(t.type==="getGAClientId"){const e=await N();window.postMessage({source:s,to:"page",from:"content",type:`${t.type}:${t.id}`,clientId:e},"*")}else if(t.type==="getGASessionId"){const e=await G();window.postMessage({source:s,to:"page",from:"content",type:`${t.type}:${t.id}`,sessionId:e},"*")}}}}),chrome.runtime.onMessage.addListener(function(o,t,e){o?.source===s&&(o?.to==="page"?window.postMessage(o,"*"):o?.to),e?.()})}if(M||E||u&&!l&&!b)return;const v=chrome.runtime.getURL("scripts/local.js");u&&!l&&i(v);const T=chrome.runtime.getURL("scripts/compat.js"),R=chrome.runtime.getURL(p?"scripts/poe.js":a?"scripts/ops.js":"scripts/main.js");i(T),i(R),!a&&O()})();
