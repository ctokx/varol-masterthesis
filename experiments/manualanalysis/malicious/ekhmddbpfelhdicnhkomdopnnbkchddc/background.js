"use strict";function getTextFilename(e){const o=e.split(".");return o.pop(),o.push("txt"),o.join(".")}function downloadFile({url:e,filename:o}){return chrome.downloads.download({url:e,filename:o}).then(()=>{console.log(`\u4E0B\u8F7D\u6210\u529F: ${o}`)})}chrome.runtime.onInstalled.addListener(()=>{console.log("onInstalled")}),chrome.storage.session.setAccessLevel({accessLevel:"TRUSTED_AND_UNTRUSTED_CONTEXTS"},e=>{console.log("session.setAccessLevel",e)}),chrome.runtime.onMessage.addListener(function(e,o,n){const t=e?.source||"";if(["autojourney","autojimeng","autodoubao","autogemini","autogrok","autogpt","autosuno","autogram","autoqwen","autolovart"].includes(t.toLowerCase())&&e?.to==="background"){switch(e.type){case"downloadImage":downloadFile({url:e.url,filename:e.filename}),e.text&&downloadFile({url:e.text,filename:getTextFilename(e.filename)});break;case"notification":return chrome.notifications.create("",{type:"basic",iconUrl:"images/icon-128.png",title:e.title,message:e.message},s=>{n?.({source:t,from:"background",to:e.from,type:`${e.type}:${e.id}`,notificationId:s})}),!0}n?.({source:t,from:"background",to:e.from,type:`${e.type}:${e.id}`})}else n?.()});
